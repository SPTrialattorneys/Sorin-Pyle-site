<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    {# Page title and description #}
    <title>{% if title %}{{ title }} | {% endif %}{{ site.title }}</title>
    <meta name="description" content="{{ description or site.description }}">
    {% if keywords %}<meta name="keywords" content="{{ keywords }}">{% endif %}

    {# Canonical URL #}
    <link rel="canonical" href="{{ canonicalUrl or (site.url + page.url) }}">

    {# AI Search Optimization (optional) #}
    {% if aiSummary %}<meta name="AI-content-summary" content="{{ aiSummary }}">{% endif %}
    {% if expertise %}<meta name="expertise" content="{{ expertise }}">{% endif %}
    {% if jurisdiction %}<meta name="jurisdiction" content="{{ jurisdiction }}">{% endif %}

    {# Open Graph meta tags #}
    <meta property="og:type" content="{{ ogType or 'website' }}">
    <meta property="og:title" content="{{ ogTitle or (title + ' | ' + site.title if title else site.title) }}">
    <meta property="og:description" content="{{ ogDescription or description or site.description }}">
    <meta property="og:url" content="{{ site.url }}{{ page.url }}">
    <meta property="og:image" content="{{ ogImage or (site.url + '/images/holland-michigan-criminal-defense-lawyers.avif') }}">
    <meta property="og:site_name" content="{{ site.title }}">

    {# Twitter Card meta tags #}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% if title %}{{ title }} | {% endif %}{{ site.title }}">
    <meta name="twitter:description" content="{{ description or site.description }}">
    <meta name="twitter:image" content="{{ site.url }}/images/holland-michigan-criminal-defense-lawyers.avif">

    {# AI Search Optimization #}
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">

    {# Favicon #}
    <link rel="icon" type="image/svg+xml" href="/images/logo-icon.svg">

    {# Critical CSS - Inlined for above-the-fold rendering #}
    {% if criticalCSSFile %}
    <style>
        {{ criticalCSSFile | criticalCSS | safe }}
    </style>
    {% endif %}
    {% block criticalCSS %}{% endblock %}

    {# Deferred CSS loading (includes cookie-consent CSS bundled in) #}
    <link rel="preload" href="/css/main.min.css?v=20251125-14" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="/css/main.min.css?v=20251125-14"></noscript>

    {# Page-specific CSS #}
    {% block pageCss %}{% endblock %}

    {# Schema markup #}
    {% block schema %}{% endblock %}

    {# Page-specific head content #}
    {% block head %}{% endblock %}

    {# Google Analytics - Deferred #}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ site.analytics.measurementId }}"></script>
    <script src="/js/analytics.js"></script>
</head>
<body>
    {# Skip to main content link for accessibility #}
    <a href="#main-content" class="skip-link">Skip to main content</a>

    {# Header/Navigation #}
    {% include "partials/header.njk" %}

    {# Main content area #}
    <main id="main-content">
        {% block content %}{% endblock %}
    </main>

    {# Footer #}
    {% include "partials/footer.njk" %}

    {# Cookie Consent Banner - Dynamically created by cookie-consent.js #}

    {# Deferred JavaScript #}
    <script src="/js/main.min.js" defer></script>
    <script src="/js/cookie-consent.js" defer></script>

    {# Page-specific scripts #}
    {% block scripts %}{% endblock %}
</body>
</html>
